webpackJsonp([24],{Ckmt:function(t,s,e){"use strict";var a={title:"笔记：TypeScript 中引用全局变量",keywords:"原创,TypeScript",pathname:"ts-note-on-global-reference",translation:null,create_time:"2016-09-08",prev:{title:"[译] 函数式 TypeScript",pathname:"functional-refactor-typescript"},next:{title:"[译] 让人倾倒的 11 个 npm trick",pathname:"eleven-npm-tricks-that-will-knock-your-wombat-socks-off"}};s.a={head:function(){return{title:a.title,meta:[{name:"keywords",content:a.keywords||""},{name:"description",content:a.description}]}},data:function(){return{post:a,post_url:this.$config.site_url+"/post/"+a.pathname,tags:a.tags}},mounted:function(){this.$fixCode()}}},NxKT:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"page-post"}},[e("article",{staticClass:"post detail"},[e("div",{staticClass:"meta"},[e("div",{staticClass:"date"},[t._v(t._s(t.post.create_time))])]),e("h1",{staticClass:"title"},[t._v(t._s(t.post.title))]),e("div",{staticClass:"entry-content"},[t.post.translation?e("blockquote",[e("p",{staticStyle:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v("\n        原文作者: "),e("a",{attrs:{href:t.post.translation.social,target:"_blank"}},[t._v(t._s(t.post.translation.author))]),e("br"),t._v("\n        原文地址: "),e("a",{attrs:{href:t.post.translation.from}},[t._v(t._s(t.post.translation.from))]),e("br"),t._v("\n        译文地址: "),e("a",{attrs:{href:t.post_url}},[t._v(t._s(t.post_url))]),e("br"),t._v("\n        本文由 "),e("a",{attrs:{href:this.$config.site_url}},[t._v(t._s(this.$config.site_owner))]),t._v(" 翻译，转载请保留此声明。"),e("br"),t._v("\n        著作权属于原作者，本译文仅用于学习、研究和交流目的，请勿用于商业目的。\n        ")])]):t._e(),e("p",[t._v("朋友的朋友，最近的一个项目使用了 angular.js，是使用 typescript 开发的。")]),e("p",[t._v("让我惊奇的是，竟然还是使用 1.2 版本。")]),e("p",[t._v("项目还引用了一个外部 js（没有现成的 "),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v(".d.ts")]),t._v(" 文件可用）。这个 js 文件暴露了一个全局变量，需要在 ts 文件中调用。暂且命名为 "),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("ClassOutOfTS")]),t._v("。")]),e("p",[t._v("那么问题来了。在 ts 中直接调用 "),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("new ClassOutOfTS()")]),t._v(" 会引起编译报错，因为 ts 编译器根本就找不到 "),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("ClassOutOfTS")]),t._v("的定义。")]),e("p",[t._v("想想实在没什么好办法。那就自己去写个 "),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v(".d.ts")]),t._v(" 文件好啦。")]),e("p",[t._v("等等，好像不对。")]),e("p",[t._v("我最近两周的空闲时间在看 angular2，好像有个例子中，出现过对 "),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("window")]),t._v(" 特殊处理的情况。")]),e("p",[t._v("查查代码，还真有。废话少说，直接上代码：")]),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"pre-area",attrs:{width:"0",height:"0"}},[t._v('<code class="hljs lang-typescript">%3Cspan%20class%3D%22hljs-keyword%22%3Evar%3C%2Fspan%3E%20ins%3A%3Cspan%20class%3D%22hljs-built_in%22%3Eany%3C%2Fspan%3E%20%3D%20(%26lt%3B%3Cspan%20class%3D%22hljs-built_in%22%3Eany%3C%2Fspan%3E%26gt%3B%3Cspan%20class%3D%22hljs-built_in%22%3Ewindow%3C%2Fspan%3E).ClassOutOfTS()%3B</code>')]),e("p",[t._v("虽然这办法很黑，可是也没什么更好的了。")]),e("p",[t._v("简单解释下。上面这行代码中，关键部分是 "),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("<any>window")]),t._v(" 这一句。"),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("<any>")]),t._v(" 在这里的作用是强制类型转换。")]),e("p",[t._v("编译器并不知晓 window 下面有哪些属性、方法。但强制转换成 any 类型之后，就不会报错了。")]),e("p",[t._v("单记录下。以备不时之需。")]),e("h2",{attrs:{id:"2016-10-20-update"}},[t._v("2016-10-20 Update")]),e("p",[t._v("另外一种类似的办法是，在当前文件再 declare 一下。")]),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"pre-area",attrs:{width:"0",height:"0"}},[t._v('<code class="hljs lang-typescript">%3Cspan%20class%3D%22hljs-keyword%22%3Edeclare%3C%2Fspan%3E%20%3Cspan%20class%3D%22hljs-keyword%22%3Econst%3C%2Fspan%3E%20%3Cspan%20class%3D%22hljs-built_in%22%3Ewindow%3C%2Fspan%3E%3B%0A%3Cspan%20class%3D%22hljs-keyword%22%3Evar%3C%2Fspan%3E%20ins%3A%20%3Cspan%20class%3D%22hljs-built_in%22%3Eany%3C%2Fspan%3E%20%3D%20%3Cspan%20class%3D%22hljs-built_in%22%3Ewindow%3C%2Fspan%3E.ClassOutOfTS()%3B</code>')])])]),t.post.prev.title||t.post.next.title?e("nav",{staticClass:"pagination"},[t.post.prev.title?e("nuxt-link",{staticClass:"prev",attrs:{to:"/post/"+t.post.prev.pathname,title:t.post.prev.title}},[t._v("« "+t._s(t.post.prev.title))]):t._e(),t.post.next.title?e("nuxt-link",{staticClass:"next",attrs:{to:"/post/"+t.post.next.pathname,title:t.post.next.title}},[t._v(t._s(t.post.next.title)+" »")]):t._e()],1):t._e(),e("gitalk",{attrs:{tags:t.tags}})],1)};a._withStripped=!0;var i={render:a,staticRenderFns:[]};s.a=i},bsTO:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("Ckmt"),i=e("NxKT"),n=e("VU/8")(a.a,i.a,!1,null,null,null);n.options.__file="pages/post/ts-note-on-global-reference.vue",s.default=n.exports}});
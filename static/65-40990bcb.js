webpackJsonp([65],{"3ey3":function(t,e,a){"use strict";var s={title:"[译] font-display 的使用",description:"font-display 的使用",keywords:"翻译,CSS,性能",pathname:"font-display",translation:{author:"Rob Dodson",social:"https://twitter.com/rob_dodson",from:"https://developers.google.com/web/updates/2016/02/font-display"},create_time:"2017-08-04",prev:{title:"ArrayBuffer and TypedArray in ES2015",pathname:"es2015-arraybuffer"},next:{title:"[译] 事件代理：模式 or 反模式？",pathname:"event-delegation-pattern-or-anti-pattern"}};e.a={head:function(){return{title:s.title,meta:[{name:"keywords",content:s.keywords||""},{name:"description",content:s.description}]}},data:function(){return{post:s,post_url:this.$config.site_url+"/post/"+s.pathname,tags:s.tags}},mounted:function(){this.$fixCode()}}},G3Rx:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"page-post"}},[a("article",{staticClass:"post detail"},[a("div",{staticClass:"meta"},[a("div",{staticClass:"date"},[t._v(t._s(t.post.create_time))])]),a("h1",{staticClass:"title"},[t._v(t._s(t.post.title))]),a("div",{staticClass:"entry-content"},[t.post.translation?a("blockquote",[a("p",{staticStyle:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v("\n        原文作者: "),a("a",{attrs:{href:t.post.translation.social,target:"_blank"}},[t._v(t._s(t.post.translation.author))]),a("br"),t._v("\n        原文地址: "),a("a",{attrs:{href:t.post.translation.from}},[t._v(t._s(t.post.translation.from))]),a("br"),t._v("\n        译文地址: "),a("a",{attrs:{href:t.post_url}},[t._v(t._s(t.post_url))]),a("br"),t._v("\n        本文由 "),a("a",{attrs:{href:this.$config.site_url}},[t._v(t._s(this.$config.site_owner))]),t._v(" 翻译，转载请保留此声明。"),a("br"),t._v("\n        著作权属于原作者，本译文仅用于学习、研究和交流目的，请勿用于商业目的。\n        ")])]):t._e(),a("p",[t._v("进行性能优化时，决定 Web Font 的加载行为是一项技术活。"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("@font-face")]),t._v("规则中新增了一个"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("声明，开发者可以根据 Web Font 的加载时间来决定如何渲染或降级处理。")]),a("h2",{attrs:{id:"-"}},[t._v("字体渲染差异")]),a("p",[t._v("有了 Web Font，开发者可以在项目中加入丰富的排版功能。但需要权衡的是，下载字体会耗费一些时间。而下载时间难免会受到网络状况的影响，继而干扰用户体验。说实话，如果连页面展示都费劲，谁还会在乎你用多炫的字体呢。")]),a("p",[t._v("字体下载可能比较慢，为了减轻风险，大多数浏览器都采用了超时处理。一旦超时，就使用后备字体。理想很美好，现实很无奈，浏览器在实现上各有自己的一套。")]),t._m(0),t._m(1),a("p",[t._v("更糟糕的是，这些规则对应用造成的影响，在很大程度上不受开发者控制。关注性能的开发者也许更乐意使用后备字体，使网页内容更快地展现，当更美观的 Web Font 下载完成后再加以使用。使用 Font Loading API 之类的工具，可以覆盖浏览器的某些默认行为，提升性能。但这将引入额外的 JavaScript 代码 —— 要么把代码内联到页面中；要么请求外部文件，而这可能带来额外的 HTTP 延时。")]),a("p",[t._v("CSS 工作组为此提出了新方案：为"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("@font-face")]),t._v("增加新的"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("声明，用于控制字体下载完成之前的渲染行为。")]),a("h2",{attrs:{id:"-"}},[t._v("字体下载时间轴")]),a("p",[t._v("与一些浏览器目前使用的字体超时行为类似，"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("将字体下载过程划分为三个阶段。")]),t._m(2),a("p",[t._v("理解以上三个阶段，根据字体是否下载成功、何时下载完成等情况，就可以可以使用"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("来决定如何渲染字体了。")]),a("h2",{attrs:{id:"-font-display-"}},[t._v("使用哪种 font-display 值？")]),a("p",[t._v("要使用"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("，请在"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("@font-face")]),t._v("规则中添加代码：")]),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"pre-area",attrs:{width:"0",height:"0"}},[t._v("<code class=\"hljs lang-css\">%40%3Cspan%20class%3D%22hljs-keyword%22%3Efont-face%3C%2Fspan%3E%20%7B%0A%20%20%3Cspan%20class%3D%22hljs-attribute%22%3Efont-family%3C%2Fspan%3E%3A%20%20%3Cspan%20class%3D%22hljs-string%22%3E'Arvo'%3C%2Fspan%3E%3B%0A%20%20%3Cspan%20class%3D%22hljs-attribute%22%3Efont-display%3C%2Fspan%3E%3A%20%20auto%3B%0A%20%20%3Cspan%20class%3D%22hljs-attribute%22%3Esrc%3C%2Fspan%3E%3A%20%20%3Cspan%20class%3D%22hljs-built_in%22%3Elocal%3C%2Fspan%3E(%3Cspan%20class%3D%22hljs-string%22%3E'Arvo'%3C%2Fspan%3E)%2C%20%3Cspan%20class%3D%22hljs-built_in%22%3Eurl%3C%2Fspan%3E(https%3A%2F%2Ffonts.gstatic.com%2Fs%2Farvo%2Fv9%2FrC7kKhY-eUDY-ucISTIf5PesZW2xOQ-xsNqO47m55DA.woff2)%20%3Cspan%20class%3D%22hljs-built_in%22%3Eformat%3C%2Fspan%3E(%3Cspan%20class%3D%22hljs-string%22%3E'woff2'%3C%2Fspan%3E)%3B%0A%7D</code>")]),a("p",[t._v("目前，"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("支持"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("auto | block | swap | fallback | optional")]),t._v("五种值。")]),a("h3",{attrs:{id:"auto"}},[t._v("auto")]),a("p",[a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("auto")]),t._v("使用的字体展示策略与浏览器一致。当前，大多数浏览器使用的默认策略类似"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("block")]),t._v("。")]),a("h3",{attrs:{id:"block"}},[t._v("block")]),a("p",[a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("block")]),t._v("给予字体一个较短的阻塞时间（大多数情况下推荐使用 3s）和无限大的交换时间。换言之，如果字体未加载完成，浏览器将首先绘制“隐形”文本；一旦字体加载完成，立即切换字体。为此，浏览器将创建一个匿名字体，其类型与所选字体相似，但所有字形都不含“墨水”。使用特定字体渲染文本之后页面方才可用，只有这种情况下才应该使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("block")]),t._v("。")]),a("h3",{attrs:{id:"swap"}},[t._v("swap")]),a("p",[t._v("使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("swap")]),t._v("，则阻塞阶段时间为 0，交换阶段时间无限大。也就是说，如果字体没有完成加载，浏览器会立即绘制文字，一旦字体加载成功，立即切换字体。与 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("block")]),t._v(" 类似，如果使用特定字体渲染文本对页面很重要，且使用其他字体渲染仍将显示正确的信息，才应使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("swap")]),t._v("。Logo 文字就很适合使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("swap")]),t._v("，因为以合理的后备字体显示公司名称仍将正确传递信息，而且最终会以官方字体的样式展现。")]),a("h3",{attrs:{id:"fallback"}},[t._v("fallback")]),a("p",[t._v("使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("fallback")]),t._v("时，阻塞阶段时间将非常小（多数情况下推荐小于 100ms），交换阶段也比较短（多数情况下建议使用 3 秒钟）。换言之，如果字体没有加载，则首先会使用后备字体渲染。一旦加载成功，就会切换字体。但如果等待时间过久，则页面将一直使用后备字体。如果希望用户尽快开始阅读，而且不因新字体的载入导致文本样式发生变动而干扰用户体验，"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("fallback")]),t._v(" 是一个很好的选择。举个例子，正文文本就符合这个条件。")]),a("h3",{attrs:{id:"optional"}},[t._v("optional")]),a("p",[t._v("使用 optional 时，阻塞阶段时间会非常小（多数情况下建议低于 100ms），交换阶段时间为 0。与 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("fallback")]),t._v(" 类似，如果字体能够为页面效果增色不少，但并非特别重要时，使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("optional")]),t._v(" 正好。使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("optional")]),t._v(" 时，将由浏览器来决定是否开始下载字体。可以不下载，也可以给予字体较低的优先级，一切取决于浏览器是否认为对用户最有利。当用户处于弱网络下，这是非常有用的，下载字体可能并非对资源最好的利用。")]),a("h2",{attrs:{id:"-"}},[t._v("浏览器支持")]),a("p",[t._v("启用 Chrome 49 桌面版、Opera 或 Opera for Android的 “Experimental Web Platform Features flag” 后可以使用 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("。（译者注：该文发表于 2016 年。根据译者 2017 年 8 月 4 日访问"),a("a",{attrs:{href:"http://caniuse.com/#search=font-display",target:"_blank"}},[t._v("caniuse")]),t._v("获取的信息，Chrome 60 正式引入 "),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("。）")]),a("h2",{attrs:{id:"demo"}},[t._v("Demo")]),a("p",[t._v("点击"),a("a",{attrs:{href:"https://jsbin.com/nigahi/latest/edit?html,output",target:"_blank"}},[t._v("链接")]),t._v("可以查看"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v("的效果。对关注性能的开发者来说，"),a("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"codespan",attrs:{width:"0",height:"0"}},[t._v("font-display")]),t._v(" 可是相当有用的工具啊！")])])]),t.post.prev.title||t.post.next.title?a("nav",{staticClass:"pagination"},[t.post.prev.title?a("nuxt-link",{staticClass:"prev",attrs:{to:"/post/"+t.post.prev.pathname,title:t.post.prev.title}},[t._v("« "+t._s(t.post.prev.title))]):t._e(),t.post.next.title?a("nuxt-link",{staticClass:"next",attrs:{to:"/post/"+t.post.next.pathname,title:t.post.next.title}},[t._v(t._s(t.post.next.title)+" »")]):t._e()],1):t._e(),a("gitalk",{attrs:{tags:t.tags}})],1)};s._withStripped=!0;var i={render:s,staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"left"}},[t._v("Browser")]),a("th",{staticStyle:{"text-align":"left"}},[t._v("Timeout")]),a("th",{staticStyle:{"text-align":"left"}},[t._v("Fallback")]),a("th",{staticStyle:{"text-align":"left"}},[t._v("Swap")])])]),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("Chrome 35+")])]),a("td",{staticStyle:{"text-align":"left"}},[t._v("3 seconds")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("Opera")])]),a("td",{staticStyle:{"text-align":"left"}},[t._v("3 seconds")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("Firefox")])]),a("td",{staticStyle:{"text-align":"left"}},[t._v("3 seconds")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("Internet Explorer")])]),a("td",{staticStyle:{"text-align":"left"}},[t._v("0 seconds")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("Yes")])]),a("tr",[a("td",{staticStyle:{"text-align":"left"}},[a("strong",[t._v("Safari")])]),a("td",{staticStyle:{"text-align":"left"}},[t._v("No timeout")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("N/A")]),a("td",{staticStyle:{"text-align":"left"}},[t._v("N/A")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("p",[this._v("Chrome 和 Firefox 超时时间为 3 秒，超时后使用后备字体。若字体最终勉强加载成功，它将替换后备字体，重新渲染文本。")])]),e("li",[e("p",[this._v("IE 浏览器超时时间为 0 秒，也就是说，会立即渲染文本。若所请求的字体尚不可用，则使用后备字体。一旦请求字体可用，将重新渲染文本。")])]),e("li",[e("p",[this._v("Safari 没有超时行为（或者说，至少在基准网络超时之前什么也没干）。")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[e("p",[this._v("首先是字体阻塞阶段（font block period）。在此期间，如果字体未完成加载，则尝试使用它的任何元素必须以不可见的后备字体形式呈现；否则正常使用该字体。")])]),e("li",[e("p",[this._v("紧接着字体阻塞阶段的是字体交换阶段（font swap period）。在此期间，如果字体未完成加载，则尝试使用它的任何元素必须使用后备字体进行渲染；否则正常使用该字体。")])]),e("li",[e("p",[this._v("紧接着是字体故障阶段（font failure period）。此时若字体未完成加载，则将其标记为下载失败，并使用常规后备字体；否则正常使用该字体。")])])])}]};e.a=i},hvJs:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("3ey3"),i=a("G3Rx"),l=a("VU/8")(s.a,i.a,!1,null,null,null);l.options.__file="pages/post/font-display.vue",e.default=l.exports}});
webpackJsonp([83],{CRoA:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"page-post"}},[e("article",{staticClass:"post detail"},[e("div",{staticClass:"meta"},[e("div",{staticClass:"date"},[t._v(t._s(t.post.create_time))])]),e("h1",{staticClass:"title"},[t._v(t._s(t.post.title))]),e("div",{staticClass:"entry-content"},[t.post.translation?e("blockquote",[e("p",{staticStyle:{"white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},[t._v("\n        原文作者: "),e("a",{attrs:{href:t.post.translation.social,target:"_blank"}},[t._v(t._s(t.post.translation.author))]),e("br"),t._v("\n        原文地址: "),e("a",{attrs:{href:t.post.translation.from}},[t._v(t._s(t.post.translation.from))]),e("br"),t._v("\n        译文地址: "),e("a",{attrs:{href:t.post_url}},[t._v(t._s(t.post_url))]),e("br"),t._v("\n        本文由 "),e("a",{attrs:{href:this.$config.site_url}},[t._v(t._s(this.$config.site_owner))]),t._v(" 翻译，转载请保留此声明。"),e("br"),t._v("\n        著作权属于原作者，本译文仅用于学习、研究和交流目的，请勿用于商业目的。\n        ")])]):t._e(),t._m(0),t._m(1),t._m(2),t._m(3),e("p",[t._v("理论扯够了。现在来点实际操作……")]),t._m(4),t._m(5),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"pre-area",attrs:{width:"0",height:"0"}},[t._v('<code class="hljs lang-html">%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%3Cspan%20class%3D%22hljs-name%22%3Eiframe%3C%2Fspan%3E%20%3Cspan%20class%3D%22hljs-attr%22%3Esrc%3C%2Fspan%3E%3D%3Cspan%20class%3D%22hljs-string%22%3E%22https%3A%2F%2Fhtml5forwebdesigners.com%2Fiframe.html%22%3C%2Fspan%3E%20%3Cspan%20class%3D%22hljs-attr%22%3Estyle%3C%2Fspan%3E%3D%3Cspan%20class%3D%22hljs-string%22%3E%22width%3A%200%3B%20height%3A%200%3B%20border%3A%200%22%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%2F%3Cspan%20class%3D%22hljs-name%22%3Eiframe%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E</code>')]),t._m(6),e("textarea",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"pre-area",attrs:{width:"0",height:"0"}},[t._v("<code class=\"hljs lang-html\">%3Cspan%20class%3D%22hljs-meta%22%3E%26lt%3B!DOCTYPE%20html%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%3Cspan%20class%3D%22hljs-name%22%3Ehtml%3C%2Fspan%3E%20%3Cspan%20class%3D%22hljs-attr%22%3Elang%3C%2Fspan%3E%3D%3Cspan%20class%3D%22hljs-string%22%3E%22en%22%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%3Cspan%20class%3D%22hljs-name%22%3Ehead%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%3Cspan%20class%3D%22hljs-name%22%3Emeta%3C%2Fspan%3E%20%3Cspan%20class%3D%22hljs-attr%22%3Echarset%3C%2Fspan%3E%3D%3Cspan%20class%3D%22hljs-string%22%3E%22utf-8%22%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%3Cspan%20class%3D%22hljs-name%22%3Etitle%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3EHTML5%20For%20Web%20Designers%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%2F%3Cspan%20class%3D%22hljs-name%22%3Etitle%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%3Cspan%20class%3D%22hljs-name%22%3Escript%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%3Cspan%20class%3D%22actionscript%22%3E%0A%3Cspan%20class%3D%22hljs-keyword%22%3Eif%3C%2Fspan%3E%20(%3Cspan%20class%3D%22hljs-string%22%3E'serviceWorker'%3C%2Fspan%3E%20%3Cspan%20class%3D%22hljs-keyword%22%3Ein%3C%2Fspan%3E%20navigator)%20%7B%0A%20%20navigator.serviceWorker.register(%3Cspan%20class%3D%22hljs-string%22%3E'%2Fserviceworker.js'%3C%2Fspan%3E)%3B%0A%7D%0A%3C%2Fspan%3E%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%2F%3Cspan%20class%3D%22hljs-name%22%3Escript%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%2F%3Cspan%20class%3D%22hljs-name%22%3Ehead%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E%0A%3Cspan%20class%3D%22hljs-tag%22%3E%26lt%3B%2F%3Cspan%20class%3D%22hljs-name%22%3Ehtml%3C%2Fspan%3E%26gt%3B%3C%2Fspan%3E</code>")]),t._m(7),e("p",[t._v("搞定了。从未访问过 html5forwebdesigners.com 这个域名，但网站已经在你的设备上预加载过了，一切仅仅因为你访问过 adactio.com。")]),e("p",[t._v("一些注意事项：")]),e("p",[t._v("我不得不降低 html5forwebdesigners.com 的内容安全策略（Content Security Policy），以允许能通过 iframe 将其嵌入 adactio.com:")]),t._m(8),e("p",[t._v("若你的浏览器设置选择了“禁止第三方 cookie 及 网站数据”（“Block third-party cookies and site data”），通过 iframe 调用的 Service Worker 是不会被安装的：")]),t._m(9),e("p",[t._v("我在本文中的示例相对来说是无害的。不过，可以难想象一些更加极端的情形。想象有一家出版商，有 50 种出版物，每本书有一个网站。每个网站都可能有一个空页面，等待着通过 iframe 被其他 49 个网站嵌入。你只需要访问其中一个页面，就会有 50 个Service Workers 在后台运转起来缓存资源。")]),t._m(10),e("p",[t._v("千万别让广告狗们知道哦！（直译：千万别给广告行业知道这。）")])])]),t.post.prev.title||t.post.next.title?e("nav",{staticClass:"pagination"},[t.post.prev.title?e("nuxt-link",{staticClass:"prev",attrs:{to:"/post/"+t.post.prev.pathname,title:t.post.prev.title}},[t._v("« "+t._s(t.post.prev.title))]):t._e(),t.post.next.title?e("nuxt-link",{staticClass:"next",attrs:{to:"/post/"+t.post.next.pathname,title:t.post.next.title}},[t._v(t._s(t.post.next.title)+" »")]):t._e()],1):t._e(),e("gitalk",{attrs:{tags:t.tags}})],1)};a._withStripped=!0;var r={render:a,staticRenderFns:[function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("在"),s("a",{attrs:{href:"https://adactio.com/journal/10866",target:"_blank"}},[this._v("渐进式 Web App 开发峰会(Progressive Web App dev Summit)")]),this._v("上展示的时候，我花了"),s("a",{attrs:{href:"https://youtu.be/EyyEfxrk_NU?t=21m4s",target:"_blank"}},[this._v("差不多 20 分钟")]),this._v("讲了这样一点：")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("blockquote",[e("p",[e("a",{attrs:{href:"https://infrequently.org/",target:"_blank"}},[t._v("Alex")]),t._v("，你昨天演讲展示了华盛顿邮报(Washington Post)的 "),e("a",{attrs:{href:"https://www.ampproject.org/",target:"_blank"}},[t._v("AMP")]),t._v(" （——译者注：Accelerated Mobile Pages Project） demo。轻轻那么一点，华盛顿邮报的 AMP 应用就出来了，还能够通过"),e("a",{attrs:{href:"https://www.ampproject.org/docs/reference/extended/amp-install-serviceworker.html",target:"_blank"}},[t._v("自定义元素")]),t._v("安装 Service Worker。可是我去看浏览器地址栏的时候……并不是华盛顿邮报。只是 AMP 的 CDN 而已。所以我和 AMP 团队的 "),e("a",{attrs:{href:"https://paulbakaus.com/",target:"_blank"}},[t._v("Paul Backaus")]),t._v(" 聊了聊，他解释说那是一个 iframe，使用 iframe 能安装其他地方的 Service Worker。")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Alex 和 "),s("a",{attrs:{href:"https://twitter.com/emschec",target:"_blank"}},[this._v("Emily")]),this._v(" 解释说，嗯，这就是 iframe 的工作方式。当你仔细想想，其实还是挺有意义的，毕竟一个 iframe 和任何其他的浏览器窗口没什么不一样的。尽管如此，这还是会让人觉得有点违反"),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Principle_of_least_astonishment",target:"_blank"}},[this._v("最小惊奇原则")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("让我们假设，你遵循了我这并不当真的建议，去"),s("a",{attrs:{href:"https://adactio.com/journal/10800",target:"_blank"}},[this._v("创建一个渐进式的 Web 应用商店")]),this._v("，其首页可能有最新的十到二十个渐进式 Web App。你也可以同样地使用十到二十个 iframe，以便给浏览页面的用户“预安装”( pre-install )这些网站。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("假设你从未访问过我写的书的网站，"),s("a",{attrs:{href:"https://html5forwebdesigners.com/",target:"_blank"}},[this._v("html5forwebdesigners.com")]),this._v("(如果你访问过，又还想跟着我把实验进行下去，那么你得打开浏览器设置然后删除这个域下面存的所有东西)。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("也许你曾不经意间访问过我的个人网站"),s("a",{attrs:{href:"https://adactio.com/",target:"_blank"}},[this._v("adactio.com")]),this._v("。主页下面有个小广告，上面写着“Read my book”，链接指向"),s("a",{attrs:{href:"https://html5forwebdesigners.com/",target:"_blank"}},[this._v("html5forwebdesigners.com")]),this._v("。我在链接后面加了这样两行标记：")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("该隐藏的 iframe 会拉取"),s("a",{attrs:{href:"https://html5forwebdesigners.com/iframe.html",target:"_blank"}},[this._v("带有一个 script 元素的空页面")]),this._v("。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这样就注册了我的"),s("a",{attrs:{href:"https://html5forwebdesigners.com/serviceworker.js",target:"_blank"}},[this._v("书籍网站的 Service Worker")]),this._v("，然后就开始下载所有"),s("a",{attrs:{href:"https://adactio.com/journal/10754",target:"_blank"}},[this._v("离线渲染整个网站")]),this._v("所需的资源。")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Header always set Access-Control-Allow-Origin: “"),s("a",{attrs:{href:"https://adactio.com",target:"_blank"}},[this._v("https://adactio.com")]),this._v('"')])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Uncaught (in promise) DOMException: Failed to register a ServiceWorker: The user denied permission to use Service Worker.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("这就有了"),s("a",{attrs:{href:"https://en.wikipedia.org/wiki/Tragedy_of_the_commons",target:"_blank"}},[this._v("“公地悲剧”")]),this._v("的潜在可能。希望我们能清楚的知道，如何去使用这力量。")])}]};s.a=r},ErtF:function(t,s,e){"use strict";var a={title:"[译] 给 Service Worker 开后门",description:"给 Service Worker 开后门",keywords:"翻译,Service Worker",pathname:"backdoor-service-worker",translation:{author:"@Jeremy Keith",social:"https://medium.com/@adactio/",from:"https://medium.com/@adactio/backdoor-service-workers-86d241d79996#.bfuq4cdih"},create_time:"2016-07-13",prev:{title:"[译] Hybrid or Native： 适合工作的才是最好的",pathname:"hybrid-or-native-mobile-app-use-the-right-tool-for-the-job"},next:{title:"Node.js .sh scripts Manager",pathname:"Node.js-sh-scripts-Manager"}};s.a={head:function(){return{title:a.title,meta:[{name:"keywords",content:a.keywords||""},{name:"description",content:a.description}]}},data:function(){return{post:a,post_url:this.$config.site_url+"/post/"+a.pathname,tags:a.tags}},mounted:function(){this.$fixCode()}}},xVeG:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=e("ErtF"),r=e("CRoA"),i=e("VU/8")(a.a,r.a,!1,null,null,null);i.options.__file="pages/post/backdoor-service-worker.vue",s.default=i.exports}});